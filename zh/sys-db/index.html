<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据持久化 | D2 Admin</title>
    <meta name="description" content="优雅的管理系统前端集成方案">
    <link rel="icon" href="/d2-admin-doc/logo@2x.png">
  <script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?be9d34853430c136b5d62c3081d556a5";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm, s);})();</script>
    
    <link rel="preload" href="/d2-admin-doc/assets/css/0.styles.5eceaaf6.css" as="style"><link rel="preload" href="/d2-admin-doc/assets/js/app.da415d16.js" as="script"><link rel="preload" href="/d2-admin-doc/assets/js/48.7ef40e3e.js" as="script"><link rel="prefetch" href="/d2-admin-doc/assets/js/35.07fc4e59.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/2.4ce87602.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/3.dd5aff78.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/4.c2813a15.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/5.a9eea223.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/6.875aba71.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/7.a3185fe8.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/8.56c33629.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/9.2a3a88bb.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/10.75677c59.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/11.83533b2b.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/12.976650a8.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/13.fb177698.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/14.54310875.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/15.1aa2e667.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/16.19f29d1e.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/17.b14f2202.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/18.c6ac4763.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/19.14f1ae57.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/20.2716eff9.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/21.ccf5ccbf.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/22.c7b5e1ee.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/23.498cf20b.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/24.4d1a33d9.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/25.a53af64f.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/26.008e7323.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/27.2d712f30.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/28.eb352841.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/29.9a460ab7.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/30.4c253437.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/31.f8a8342c.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/32.40ffb7e3.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/33.dd252de7.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/34.001a0bd2.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/36.2d81aac5.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/37.f9924f19.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/38.477372c8.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/39.47d61bb8.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/40.dcf36007.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/41.a6084631.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/42.44009201.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/43.e8f652ac.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/44.4dd1de7c.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/45.02fc29b0.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/46.71f6ead0.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/47.a9753d68.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/49.f2de305c.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/50.19f1835b.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/51.6723056e.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/52.333dc804.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/53.f8121f4c.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/54.51e3e0f9.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/55.57554544.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/56.2d4a02f2.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/57.7ee58a01.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/58.03b0fecf.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/59.5feff24d.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/60.0cd07472.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/61.225173a2.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/62.2fa3f232.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/63.20f5d895.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/64.1b6a83cc.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/65.997793fc.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/66.dc9665d0.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/67.556d94f4.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/68.ce62f55c.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/69.084e296f.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/70.2437bbef.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/71.e80ec836.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/72.52817b4d.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/73.f1077b86.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/74.260b0bfa.js"><link rel="prefetch" href="/d2-admin-doc/assets/js/75.ff5b38f7.js">
    <link rel="stylesheet" href="/d2-admin-doc/assets/css/0.styles.5eceaaf6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/d2-admin-doc/zh/" class="home-link router-link-active"><!----> <span class="site-name">D2 Admin</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/learn-guide/" class="nav-link">教程</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/learn-knowledge/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/learn-update/" class="nav-link">升级指引</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">模块</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-components/" class="nav-link">组件</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-plugins/" class="nav-link">插件</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-vuex/" class="nav-link">vuex</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-route/" class="nav-link">路由</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-menu/" class="nav-link">菜单</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-ajax/" class="nav-link">异步请求</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-multi-page/" class="nav-link">多页面</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-db/" class="nav-link router-link-exact-active router-link-active">数据持久化</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-css/" class="nav-link">CSS 实用类</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-util/" class="nav-link">JS Util</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-cli3-webpack/" class="nav-link">cli3 和 webpack</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-admin-start-kit/" class="nav-link">D2 Admin start kit</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-admin-ice/" class="nav-link">D2 Admin ICE</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-crud/" class="nav-link">D2 CRUD</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-ribbons/" class="nav-link">D2 Ribbons</a></li></ul></div></div><div class="nav-item"><a href="/d2-admin-doc/zh/article/" class="nav-link">文章</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/change-log/" class="nav-link">更新日志</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/collaborator/" class="nav-link">参与者名单</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/plagiarize/" class="nav-link">借鉴 D2Admin 的项目</a></li><li class="dropdown-item"><h4>交流</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/d2-admin-doc/zh/communication-we/" class="nav-link">微信公众号</a></li><li class="dropdown-subitem"><a href="/d2-admin-doc/zh/communication-group-chat/" class="nav-link">交流群</a></li></ul></li><li class="dropdown-item"><h4>关注我们</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/user/57a48b632e958a006691b946/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/fairyever" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://segmentfault.com/blog/liyang-note-book" target="_blank" rel="noopener noreferrer" class="nav-link external">
  segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.zhihu.com/people/fairy-ever/activities" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>D2 在其它地方</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/vuejs/awesome-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  awesome-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://scaffold.ant.design/#/scaffolds/d2-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ant design scaffolds
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://alibaba.github.io/ice/scaffold?type=vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ice vue scaffold
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.awesomes.cn/repo/d2-projects/d2-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  awesomes.cn
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.oschina.net/p/D2admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  oschina.net
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.ctolib.com/FairyEver-d2-admin.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ctolib.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/d2-admin-doc/zh/question/" class="nav-link">常见问题</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">旧版文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://app.d3collection.cn/d2-admin-doc/1.1.11/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.1.11
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-db/" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/d2-projects/d2-admin-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/learn-guide/" class="nav-link">教程</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/learn-knowledge/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/learn-update/" class="nav-link">升级指引</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">模块</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-components/" class="nav-link">组件</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-plugins/" class="nav-link">插件</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-vuex/" class="nav-link">vuex</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-route/" class="nav-link">路由</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-menu/" class="nav-link">菜单</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-ajax/" class="nav-link">异步请求</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-multi-page/" class="nav-link">多页面</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-db/" class="nav-link router-link-exact-active router-link-active">数据持久化</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-css/" class="nav-link">CSS 实用类</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-util/" class="nav-link">JS Util</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-cli3-webpack/" class="nav-link">cli3 和 webpack</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-admin-start-kit/" class="nav-link">D2 Admin start kit</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-admin-ice/" class="nav-link">D2 Admin ICE</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-crud/" class="nav-link">D2 CRUD</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/ecosystem-d2-ribbons/" class="nav-link">D2 Ribbons</a></li></ul></div></div><div class="nav-item"><a href="/d2-admin-doc/zh/article/" class="nav-link">文章</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/change-log/" class="nav-link">更新日志</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/collaborator/" class="nav-link">参与者名单</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/plagiarize/" class="nav-link">借鉴 D2Admin 的项目</a></li><li class="dropdown-item"><h4>交流</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/d2-admin-doc/zh/communication-we/" class="nav-link">微信公众号</a></li><li class="dropdown-subitem"><a href="/d2-admin-doc/zh/communication-group-chat/" class="nav-link">交流群</a></li></ul></li><li class="dropdown-item"><h4>关注我们</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/user/57a48b632e958a006691b946/posts" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/fairyever" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://segmentfault.com/blog/liyang-note-book" target="_blank" rel="noopener noreferrer" class="nav-link external">
  segmentfault
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.zhihu.com/people/fairy-ever/activities" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>D2 在其它地方</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/vuejs/awesome-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  awesome-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://scaffold.ant.design/#/scaffolds/d2-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ant design scaffolds
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://alibaba.github.io/ice/scaffold?type=vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ice vue scaffold
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.awesomes.cn/repo/d2-projects/d2-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  awesomes.cn
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.oschina.net/p/D2admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  oschina.net
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.ctolib.com/FairyEver-d2-admin.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ctolib.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/d2-admin-doc/zh/question/" class="nav-link">常见问题</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">旧版文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://app.d3collection.cn/d2-admin-doc/1.1.11/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.1.11
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/d2-admin-doc/" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/d2-admin-doc/zh/sys-db/" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/d2-projects/d2-admin-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>数据持久化</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/d2-admin-doc/zh/sys-db/#总览" class="sidebar-link">总览</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/d2-admin-doc/zh/sys-db/#我应该选择哪种方式" class="sidebar-link">我应该选择哪种方式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/d2-admin-doc/zh/sys-db/#概念" class="sidebar-link">概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#存储实例" class="sidebar-link">存储实例</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#用户私有" class="sidebar-link">用户私有</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#路由存储" class="sidebar-link">路由存储</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#数据格式" class="sidebar-link">数据格式</a></li></ul></li><li><a href="/d2-admin-doc/zh/sys-db/#使用方式" class="sidebar-link">使用方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#root-级别方法" class="sidebar-link">root 级别方法</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#获得存储实例" class="sidebar-link">获得存储实例</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#清空存储实例" class="sidebar-link">清空存储实例</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#获得路由存储实例" class="sidebar-link">获得路由存储实例</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#清空路由存储实例" class="sidebar-link">清空路由存储实例</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#路由快照" class="sidebar-link">路由快照</a></li><li class="sidebar-sub-header"><a href="/d2-admin-doc/zh/sys-db/#路由快照清空" class="sidebar-link">路由快照清空</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="数据持久化"><a href="#数据持久化" aria-hidden="true" class="header-anchor">#</a> 数据持久化</h1> <p>D2Admin 对数据持久化做了更清晰的包装。</p> <h2 id="总览"><a href="#总览" aria-hidden="true" class="header-anchor">#</a> 总览</h2> <p>D2Admin 数据持久化依赖浏览器的 LocalStorage，使用 <a href="https://github.com/typicode/lowdb" target="_blank" rel="noopener noreferrer">lowdb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> API 加自己的取值包装实现了便捷的的操作和取值方法，通过不同的接口可以访问到持久化数据不同的内容，例如不同用户独有的存储区域，系统存储区域，公用存储，根据路由自动划分的存储区域等。</p> <p>在 <code>src/store/modules/d2admin/modules/db.js</code> 文件中提供了4组共9个方法读写持久化数据</p> <p><img src="http://fairyever.qiniudn.com/20180820235417.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <h2 id="我应该选择哪种方式"><a href="#我应该选择哪种方式" aria-hidden="true" class="header-anchor">#</a> 我应该选择哪种方式</h2> <p>有可能您会对如何选择持久化存储的 API 感到困惑，下图会帮助您在存储数据时，根据您的需要选择合适的存储方法：</p> <p><img src="http://fairyever.qiniudn.com/20180822223058.png" alt></p> <p>如果是希望读取数据，依旧遵循上图的选择条件。具体的方法介绍见本页面其它章节，具体 API 详见 <a href="/d2-admin-doc/zh/sys-vuex/db.html">vuex db 模块</a></p> <h2 id="概念"><a href="#概念" aria-hidden="true" class="header-anchor">#</a> 概念</h2> <p>D2Admin 数据持久化主要有以下概念：</p> <h3 id="存储实例"><a href="#存储实例" aria-hidden="true" class="header-anchor">#</a> 存储实例</h3> <p>首先请先对 <a href="https://github.com/typicode/lowdb" target="_blank" rel="noopener noreferrer">lowdb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 有一定的了解，<a href="https://github.com/typicode/lowdb" target="_blank" rel="noopener noreferrer">lowdb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 通过 <a href="https://lodash.com/" target="_blank" rel="noopener noreferrer">lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 实现了对数据操作的封装，下面的例子演示了 lowdb 在浏览器中的使用方式：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> low <span class="token keyword">from</span> <span class="token string">'lowdb'</span>
<span class="token keyword">import</span> LocalStorage <span class="token keyword">from</span> <span class="token string">'lowdb/adapters/LocalStorage'</span>

<span class="token keyword">const</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LocalStorage</span><span class="token punctuation">(</span><span class="token string">'db'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">low</span><span class="token punctuation">(</span>adapter<span class="token punctuation">)</span>

db<span class="token punctuation">.</span><span class="token function">defaults</span><span class="token punctuation">(</span><span class="token punctuation">{</span> posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

db<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'posts'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">'lowdb'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>D2Admin 中的存储实例指的是上述代码中 <code>db</code> 那一步（高亮行），在获得了存储实例后你可以使用 <a href="https://lodash.com/" target="_blank" rel="noopener noreferrer">lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 语法直接操作存储实例，最后使用 <a href="https://github.com/typicode/lowdb" target="_blank" rel="noopener noreferrer">lowdb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的 <code>write</code> API 将变化同步回浏览器的 LocalStorage。</p> <h3 id="用户私有"><a href="#用户私有" aria-hidden="true" class="header-anchor">#</a> 用户私有</h3> <p>用户私有指不同的用户使用同一个 api 访问到的存储实例指向的存储位置，例如 A 用户使用下面的代码存储了一段信息：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db
  <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'myName'</span><span class="token punctuation">,</span> <span class="token string">'userA'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>B 用户使用下面的代码存储了一段信息：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db
  <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'myName'</span><span class="token punctuation">,</span> <span class="token string">'userB'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>请注意代码的前三行都是一样的，两个用户使用的获取存储实例接口是同一个接口，只不过保存的数据不同。</p> <p>然后 A 和 B 使用同样的取值代码取值：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br></div><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> myName <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'myName'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>这次是使用完全一样的代码，但是 A 用户登录的情况下取得的值是 <code>myName = userA</code>，B 用户登录的情况下取得的值是 <code>myName = userB</code>。</p> <p>上面介绍的特性即为“用户私有”，<strong>在 D2Admin 中，所有的数据持久化 API 都支持数据私有配置</strong>。</p> <h3 id="路由存储"><a href="#路由存储" aria-hidden="true" class="header-anchor">#</a> 路由存储</h3> <p>路由存储含义和上面介绍的“用户私有”相像，区别如下：</p> <table><thead><tr><th>概念</th> <th>数据区分依据</th></tr></thead> <tbody><tr><td>用户私有</td> <td>用户 uuid</td></tr> <tr><td>路由存储</td> <td><code>route.name</code> 或者 <code>path</code> 或者 <code>fullPath</code></td></tr></tbody></table> <p>举例说明：</p> <p>在 <strong>页面1</strong> 中使用下面的代码存储一段信息：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db
  <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'pageName'</span><span class="token punctuation">,</span> <span class="token string">'page1'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>在 <strong>页面2</strong> 中使用同样的代码存储一段不同的信息：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db
  <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'pageName'</span><span class="token punctuation">,</span> <span class="token string">'page2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>然后在 <strong>页面1</strong> 和 <strong>页面2</strong> 上使用完全相同的代码取值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> pageName <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'pageName'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>在 <strong>页面1</strong> 中会取到 <code>pageName = page1</code>，在 <strong>页面2</strong> 中会取到 <code>pageName = page2</code>。证明数据被依据路由划分。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>“路由存储”同时也支持“用户私有”，您可以将两者结合使用，使用下面的代码即可获得用户私有的路由存储：</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div> <h3 id="数据格式"><a href="#数据格式" aria-hidden="true" class="header-anchor">#</a> 数据格式</h3> <p>首先展示完整的 D2Admin 数据存储格式：</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>不要被这张图吓到，在您使用过程中根本不会对这个结构有任何感知，API 会直接返回供您操作的节点。</p></div> <p><img src="http://fairyever.qiniudn.com/20180821090300.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>这张图体现了数据的普通存储、用户存储、路由存储、私有路由存储、路由快照以及私有路由快照的存储位置，现在您会感觉很乱，但是请注意以下几点：</p> <ul><li>sys 模块您在业务代码中不会访问</li> <li>database 中的存储结构您绝不会使用某一个 API 全部获得，每次您操作的只是某个节点下的一部分数据，D2Admin 通过不同 API 来简化您在上述数数据中快速定位到需要的数据节点</li></ul> <h2 id="使用方式"><a href="#使用方式" aria-hidden="true" class="header-anchor">#</a> 使用方式</h2> <h3 id="root-级别方法"><a href="#root-级别方法" aria-hidden="true" class="header-anchor">#</a> root 级别方法</h3> <p>root 级别的方法有两个，分别为：</p> <ul><li><a href="/d2-admin-doc/zh/sys-vuex/db.html#actions-set">d2admin/db/set</a></li> <li><a href="/d2-admin-doc/zh/sys-vuex/db.html#actions-get">d2admin/db/get</a></li></ul> <p>调用方式为：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 写入数据</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/set'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  dbName<span class="token punctuation">:</span> <span class="token string">'database'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'demo.sometext'</span><span class="token punctuation">,</span>
  value<span class="token punctuation">:</span> <span class="token string">'Hello World'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 读取数据</span>
<span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/get'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  dbName<span class="token punctuation">:</span> <span class="token string">'database'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'demo.sometext'</span><span class="token punctuation">,</span>
  defaultValue<span class="token punctuation">:</span> <span class="token string">'Hello World'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>这两个方法可以在持久化数据中的任意位置（也就是上面“数据格式”章节中展示的图片上所有节点）进行读写操作，D2Admin 内部模块使用此 API 访问持久化数据，<strong>不建议在业务代码中使用</strong>，除非您非常清楚您正在做什么。</p> <h3 id="获得存储实例"><a href="#获得存储实例" aria-hidden="true" class="header-anchor">#</a> 获得存储实例</h3> <p>要想向持久化数据中写入数据或者读取数据，第一步就是获得存储实例。可以通过 <code>d2admin/db/get</code> 获得存储实例。</p> <h4 id="公用"><a href="#公用" aria-hidden="true" class="header-anchor">#</a> 公用</h4> <p>使用如下代码获取公用存储实例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">)</span>
</code></pre></div><p>您将获得下图所示节点（绿色高亮区域）：</p> <p><img src="http://fairyever.qiniudn.com/20180821091548.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>写入：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">)</span>
db
  <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'keyName'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>结果：</p> <p><img src="http://fairyever.qiniudn.com/20180821092216.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>取值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'keyName'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'value'</span>
</code></pre></div><h4 id="私有"><a href="#私有" aria-hidden="true" class="header-anchor">#</a> 私有</h4> <p>如果需要，您也可以获取根据用户区分的私有存储实例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>假设当前登录用户的 uuid 为 uuid-A，您将获得下图所示节点（绿色高亮区域）：</p> <p><img src="http://fairyever.qiniudn.com/20180821092920.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>写入：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db
  <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'keyName'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>结果：</p> <p><img src="http://fairyever.qiniudn.com/20180821093132.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>取值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/database'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'keyName'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'value'</span>
</code></pre></div><p>如果是不同用户分别进行了存储（获取实例方法一样，但是存储了不同的值），存储结果将是：</p> <p><img src="http://fairyever.qiniudn.com/20180821093321.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>取值时将分别取到 value1，value2，value3</p> <h3 id="清空存储实例"><a href="#清空存储实例" aria-hidden="true" class="header-anchor">#</a> 清空存储实例</h3> <p>使用下面的代码清空存储实例：</p> <h4 id="公有"><a href="#公有" aria-hidden="true" class="header-anchor">#</a> 公有</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databaseClear'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="私有-2"><a href="#私有-2" aria-hidden="true" class="header-anchor">#</a> 私有</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databaseClear'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="获得路由存储实例"><a href="#获得路由存储实例" aria-hidden="true" class="header-anchor">#</a> 获得路由存储实例</h3> <h4 id="公用-2"><a href="#公用-2" aria-hidden="true" class="header-anchor">#</a> 公用</h4> <p>假设当前页面路由信息为：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-1'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page1'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span>
</code></pre></div><p>使用如下代码获取公用路由存储实例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>您将获得下图所示节点（绿色高亮区域）：</p> <p><img src="http://fairyever.qiniudn.com/20180821094404.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>写入：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db
  <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'pageName'</span><span class="token punctuation">,</span> <span class="token string">'page-1'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>结果：</p> <p><img src="http://fairyever.qiniudn.com/20180821094549.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>取值：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'pageName'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// page-1</span>
</code></pre></div><p>假设在下列页面中都进行存储操作（获取实例方法一样，但是存储了不同的值）：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-1'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page1'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-2'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page2'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-3'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page3'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span>
</code></pre></div><p>结果：</p> <p><img src="http://fairyever.qiniudn.com/20180821095545.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>三个页面取值时也会分别取到 page-1，page-2，page-3</p> <h4 id="私有-3"><a href="#私有-3" aria-hidden="true" class="header-anchor">#</a> 私有</h4> <p>路由存储支持私有化，即每个用户的路由存储相互区分，使用方法和普通的路由存储基本一致，只是在获取存储实例时增加一个参数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePage'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>这样在每个用户进行路由存储操作的时候数据会相互隔离。</p> <p>例如 <strong>用户 A</strong> 在 <strong>页面1</strong> 中使用上述代码取得的存储实例指向位置为：</p> <p><img src="http://fairyever.qiniudn.com/20180821100933.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p><strong>用户 B</strong> 在 <strong>页面1</strong> 中使用上述代码取得的存储实例指向位置为：</p> <p><img src="http://fairyever.qiniudn.com/20180821101019.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>如果 <strong>用户 A</strong>，<strong>用户 B</strong> 在 <strong>页面1</strong>，<strong>页面2</strong> 分别都存储了数据，最后结果大致这样：</p> <p><img src="http://fairyever.qiniudn.com/20180821101536.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <h3 id="清空路由存储实例"><a href="#清空路由存储实例" aria-hidden="true" class="header-anchor">#</a> 清空路由存储实例</h3> <h4 id="公有-2"><a href="#公有-2" aria-hidden="true" class="header-anchor">#</a> 公有</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePageClear'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="私有-4"><a href="#私有-4" aria-hidden="true" class="header-anchor">#</a> 私有</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/databasePageClear'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="路由快照"><a href="#路由快照" aria-hidden="true" class="header-anchor">#</a> 路由快照</h3> <p>路由快照操作相当于路由存储的一个快捷操作方式，旨在<strong>快速将当前页面的 $data 数据持久化</strong>。</p> <p>路由快照将会存储到当前路由存储的 $data 字段下。</p> <h4 id="公有-3"><a href="#公有-3" aria-hidden="true" class="header-anchor">#</a> 公有</h4> <p>假设当前页面路由信息为：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-1'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page1'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span>
</code></pre></div><p>使用如下代码存储当前页面快照：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/pageSet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>结果：</p> <p><img src="http://fairyever.qiniudn.com/20180821102036.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>使用如下代码将快照数据还原回页面：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取数据</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/pageGet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 将数据还原到页面</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>假设在下列页面中都进行快照操作：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-1'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page1'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-2'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page2'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'page-3'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> <span class="token string">'/page3'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> component
<span class="token punctuation">}</span>
</code></pre></div><p>每个页面的快照将会区分存放：</p> <p><img src="http://fairyever.qiniudn.com/20180821102520.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <h4 id="私有-5"><a href="#私有-5" aria-hidden="true" class="header-anchor">#</a> 私有</h4> <p>路由快照支持私有化，即每个用户的路由快照相互区分，使用方法和普通的路由快照基本一致，只是在操作快照时增加一个参数：</p> <p>存储快照：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/pageSet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>读取快照：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取数据</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/pageGet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>这样在每个用户进行路由快照操作的时候数据会相互隔离。</p> <p>例如 <strong>用户 A</strong> 在 <strong>页面1</strong> 中存储了快照：</p> <p><img src="http://fairyever.qiniudn.com/20180821103126.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p><strong>用户 B</strong> 在 <strong>页面1</strong> 中存储了快照：</p> <p><img src="http://fairyever.qiniudn.com/20180821103205.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <p>如果 <strong>用户 A</strong>，<strong>用户 B</strong> 在 <strong>页面1</strong>，<strong>页面2</strong> 分别都存储了数据，最后结果大致这样：</p> <p><img src="http://fairyever.qiniudn.com/20180821103306.png?imageMogr2/auto-orient/thumbnail/1480x/blur/1x0/quality/100%7Cimageslim" alt></p> <h3 id="路由快照清空"><a href="#路由快照清空" aria-hidden="true" class="header-anchor">#</a> 路由快照清空</h3> <h4 id="公有-4"><a href="#公有-4" aria-hidden="true" class="header-anchor">#</a> 公有</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/pageClear'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="私有-6"><a href="#私有-6" aria-hidden="true" class="header-anchor">#</a> 私有</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'d2admin/db/pageClear'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/d2-projects/d2-admin-doc/edit/master/doc/zh/sys-db/README.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新: </span> <span class="time">9/11/2018, 11:45:57 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/d2-admin-doc/assets/js/48.7ef40e3e.js" defer></script><script src="/d2-admin-doc/assets/js/app.da415d16.js" defer></script>
  </body>
</html>
